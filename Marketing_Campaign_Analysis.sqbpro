<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="marketing_analysis02.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="4374"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="raw_marketing" custom_title="0" dock_id="1" table="4,13:mainraw_marketing"/><dock_state state="000000ff00000000fd00000001000000020000043c000002befc0100000001fb000000160064006f0063006b00420072006f007700730065003101000000000000043c0000012d00ffffff0000043c0000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="raw_marketing" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="1" mode="0"/></sort><column_widths><column index="1" value="46"/><column index="2" value="68"/><column index="3" value="85"/><column index="4" value="90"/><column index="5" value="54"/><column index="6" value="57"/><column index="7" value="66"/><column index="8" value="85"/><column index="9" value="55"/><column index="10" value="64"/><column index="11" value="62"/><column index="12" value="106"/><column index="13" value="101"/><column index="14" value="113"/><column index="15" value="109"/><column index="16" value="121"/><column index="17" value="116"/><column index="18" value="133"/><column index="19" value="120"/><column index="20" value="124"/><column index="21" value="91"/><column index="22" value="91"/><column index="23" value="91"/><column index="24" value="91"/><column index="25" value="91"/><column index="26" value="62"/><column index="27" value="60"/><column index="28" value="101"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">CREATE TABLE customers AS
SELECT 
  Id AS customer_id,
  Year_Birth,
  Education,
  Marital_status,
  Income,
  Kidhome,
  Teenhome,
  Dt_Customer,
  Country
FROM raw_marketing;
create table purchase AS SELECT
Id as customer_id,MntWines,MntFruits,MntMeatProducts,MntFishProducts,MntSweetProducts,MntGoldProductss,NumDealsPurchases,NumWebPurchases,NumWebPurchases,NumCatalogPurchases,NumStorePurchases,NumWebVisitsMonth
FROM raw_marketing;
CREATE TABLE campaigns AS
SELECT
  Id AS customer_id,
  AcceptedCmp1,
  AcceptedCmp2,
  AcceptedCmp3,
  AcceptedCmp4,
  AcceptedCmp5,
  Response,
  Complain
FROM raw_marketing;
SELECT 
  c.customer_id,
  c.Year_Birth,
  c.Education,
  c.Marital_status,
  cp.AcceptedCmp1,
  cp.AcceptedCmp2,
  cp.AcceptedCmp3,
  cp.AcceptedCmp4,
  cp.AcceptedCmp5,
  cp.Response
FROM customers c
JOIN campaigns cp
ON c.customer_id = cp.customer_id
LIMIT 10;
SELECT 
  SUM(AcceptedCmp1 + AcceptedCmp2 + AcceptedCmp3 + AcceptedCmp4 + AcceptedCmp5) AS total_campaign_accepts
FROM campaigns;
SELECT 
  'AcceptedCmp1' AS campaign, SUM(AcceptedCmp1) AS responses
FROM campaigns
UNION
SELECT 'AcceptedCmp2', SUM(AcceptedCmp2) FROM campaigns
UNION
SELECT 'AcceptedCmp3', SUM(AcceptedCmp3) FROM campaigns
UNION
SELECT 'AcceptedCmp4', SUM(AcceptedCmp4) FROM campaigns
UNION
SELECT 'AcceptedCmp5', SUM(AcceptedCmp5) FROM campaigns
ORDER BY responses DESC
LIMIT 1;
SELECT 
  c.Year_Birth,
  SUM(cp.AcceptedCmp1 + cp.AcceptedCmp2 + cp.AcceptedCmp3 + cp.AcceptedCmp4 + cp.AcceptedCmp5) AS total_responses
FROM customers c
JOIN campaigns cp
ON c.customer_id = cp.customer_id
GROUP BY c.Year_Birth
ORDER BY total_responses DESC
LIMIT 5;
SELECT 
  cp.AcceptedCmp1 + cp.AcceptedCmp2 + cp.AcceptedCmp3 + cp.AcceptedCmp4 + cp.AcceptedCmp5 AS total_campaigns_accepted,
  p.MntWines + p.MntFruits + p.MntMeatProducts + p.MntFishProducts + p.MntSweetProducts + p.MntGoldProductss AS total_spent
FROM customers c
JOIN campaigns cp ON c.customer_id = cp.customer_id
JOIN purchase p ON c.customer_id = p.customer_id
ORDER BY total_spent DESC
LIMIT 10;
SELECT 
  c.Education,
  SUM(cp.AcceptedCmp1 + cp.AcceptedCmp2 + cp.AcceptedCmp3 + cp.AcceptedCmp4 + cp.AcceptedCmp5) AS total_responses
FROM customers c
JOIN campaigns cp
ON c.customer_id = cp.customer_id
GROUP BY c.Education
ORDER BY total_responses DESC;
SELECT 
  c.Country,
  SUM(cp.AcceptedCmp1 + cp.AcceptedCmp2 + cp.AcceptedCmp3 + cp.AcceptedCmp4 + cp.AcceptedCmp5) AS total_responses
FROM customers c
JOIN campaigns cp
ON c.customer_id = cp.customer_id
GROUP BY c.Country
ORDER BY total_responses DESC;</sql><current_tab id="0"/></tab_sql></sqlb_project>
